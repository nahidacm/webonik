<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * @see Mage_Page_Block_Template_Links
 */
?>

<?php $_links = $this->getLinks(); ?>
<?php if(count($_links)>0): ?>
<ul class="links quick-info"<?php if($this->getName()): ?> id="<?php echo $this->getName() ?>"<?php endif;?>>
    <?php foreach($_links as $_link): ?>
        <?php if ($_link instanceof Mage_Core_Block_Abstract):?>
            <?php echo $_link->toHtml() ?>
        <?php else: ?>
            <li<?php if($_link->getIsFirst()||$_link->getIsLast()): ?> class="<?php if($_link->getIsFirst()): ?>first<?php endif; ?>
            <?php if($_link->getIsLast()): ?> last<?php endif; ?>"<?php endif; ?> 
            <?php echo $_link->getLiParams() ?>>
            
            <?php if($_link->getIsLast()){ ?>

            <?php echo $_link->getBeforeText() ?>
            <a class="<?php if( !$this->helper('customer')->isLoggedIn()){?> iconlogin <?php }else{ ?>iconlogout<?php }?>" href="<?php if( !$this->helper('customer')->isLoggedIn()){?><?php echo Mage::getUrl("customer/account/login") ;?><?php }else{ ?><?php echo Mage::getUrl("customer/account/logout") ;?><?php } ?>" title="<?php echo $_link->getTitle() ?>" <?php echo $_link->getAParams() ?>><?php echo $_link->getLabel() ?></a>
            <?php echo $_link->getAfterText() ?>

            <?php }else{ ?>

            <?php echo $_link->getBeforeText() ?>
            <a href="<?php echo $_link->getUrl() ?>" title="<?php echo $_link->getTitle() ?>" <?php echo $_link->getAParams() ?>><?php echo $_link->getLabel() ?></a>
            <?php echo $_link->getAfterText() ?>

            <?php }?><!--end if-->


        </li>
        <?php endif;?>
    <?php endforeach; ?>
</ul>
<?php endif; ?>
<script type="text/javascript">
//<![CDATA[
	$jsmart(document).ready(function($){  
		$('.quick-info li').each(function(){
		href = $(this).find('a').attr('href');		
			if( href.search('customer/account/login') != -1 ){
				$(this).addClass('login');
				$(this).append($('#login_wrap').html());
				$('#login_wrap').html("");
				$(this).find('a').bind('click', function(){
				if($(this).parent('li').hasClass('open')){
					$(this).parent('li').removeClass('open');
					$('.quick-info .block-login-top').slideUp('fast');
				}else{
					$(this).parent('li').addClass('open');
					$('.quick-info .block-login-top').slideDown('fast');
				}
				return false;
				})												
			}
		});
	});
</script>